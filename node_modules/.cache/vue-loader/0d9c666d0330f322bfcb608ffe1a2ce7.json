{"remainingRequest":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\src\\views\\admin\\Equip\\Recycling.vue?vue&type=style&index=0&id=0041ca47&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\src\\views\\admin\\Equip\\Recycling.vue","mtime":1649066141132},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouc2VhcmNoIHsNCiAgd2lkdGg6IDIwMHB4Ow0KICBib3JkZXItcmFkaXVzOiAzMHB4Ow0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIHJpZ2h0OiAtMTAwMHB4Ow0KfQ0KLmJ0biB7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgcmlnaHQ6IC0xMDIwcHg7DQp9DQo="},{"version":3,"sources":["Recycling.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Recycling.vue","sourceRoot":"src/views/admin/Equip","sourcesContent":["<template>\r\n  <div>\r\n    <el-card>\r\n      <div slot=\"header\">\r\n        <el-input\r\n          v-model=\"search\"\r\n          placeholder=\"请输入关键字...\"\r\n          class=\"search\"\r\n          @change=\"SearchList\"\r\n          clearable\r\n        ></el-input>\r\n        <el-button type=\"primary\" class=\"btn\" @click=\"toSearch\">搜索</el-button>\r\n      </div>\r\n      <div>\r\n        <el-table :data=\"rentList\" style=\"width: 100%\">\r\n          <el-table-column\r\n            prop=\"eid\"\r\n            label=\"器材ID\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"type\"\r\n            label=\"类型\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"renttime\"\r\n            label=\"租用时间\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"backtime\"\r\n            label=\"计划归还时间\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"username\"\r\n            label=\"申请人\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"status\"\r\n            label=\"器材状态\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <el-tag type=\"success\" v-if=\"row.status == 0\">完好</el-tag>\r\n              <el-tag type=\"info\" v-if=\"row.status == 1\">保修</el-tag>\r\n              <el-tag type=\"warning\" v-if=\"row.status == 2\">损坏</el-tag>\r\n              <el-tag type=\"danger\" v-if=\"row.status == 3\">报废</el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"phone\"\r\n            label=\"联系电话\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"\"\r\n            label=\"借用状态\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <el-tag\r\n                type=\"success\"\r\n                v-if=\"Date.parse(row.backtime) > new Date()\"\r\n                >正在使用</el-tag\r\n              >\r\n              <el-tag type=\"danger\" v-if=\"Date.parse(row.backtime) < new Date()\"\r\n                >过期未还</el-tag\r\n              >\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"prop\"\r\n            label=\"操作\"\r\n            width=\"width\"\r\n            align=\"center\"\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <el-button\r\n                type=\"info\"\r\n                @click=\"\r\n                  rows = row;\r\n                  isShow = true;\r\n                \"\r\n                >回收</el-button\r\n              >\r\n              <el-button type=\"danger\" @click=\"noCredit(row)\">失信</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <pagination\r\n        v-show=\"flag\"\r\n        :currentPage=\"currentPage\"\r\n        :total=\"total\"\r\n        :limit=\"limit\"\r\n        :page-sizes=\"pageSizes\"\r\n        @handleCurrentChange=\"handleCurrentChange\"\r\n        @handleSizeChange=\"handleSizeChange\"\r\n      />\r\n    </el-card>\r\n    <el-dialog title=\"提示\" :visible.sync=\"isShow\" width=\"400px\">\r\n      <div style=\"text-align: center; margin-top: -50px\">\r\n        <h3>请确认器材状态</h3>\r\n        <el-button type=\"success\" @click=\"handle(0)\">完好</el-button>\r\n        <el-button type=\"danger\" @click=\"handle(2)\">损坏</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Recycling\",\r\n\r\n  data() {\r\n    return {\r\n      isShow: false,\r\n      search: \"\",\r\n      flag:true,\r\n      data:[],\r\n      rows: {},\r\n      rentList: [],\r\n      currentPage: 1,\r\n      limit: 5,\r\n      total: 0,\r\n      pageSizes:[5,10,15,20]\r\n    };\r\n  },\r\n\r\n  mounted() {\r\n    this.getRecyclingEquipList();\r\n  },\r\n\r\n  methods: {\r\n    // 器材回收列表数据\r\n    async getRecyclingEquipList() {\r\n      const result = await this.$store.dispatch(\"getRecyclingEquiplist\");\r\n      if (result.code == 200) {\r\n        this.data = result.data\r\n        result.data.forEach((item) => {\r\n          item.renttime = this.$moment(item.renttime).format(\r\n            \"YYYY-MM-DD HH:mm:ss\"\r\n          );\r\n          item.backtime = this.$moment(item.backtime).format(\r\n            \"YYYY-MM-DD HH:mm:ss\"\r\n          );\r\n        });\r\n        this.rentList = [];\r\n        this.rentList = result.data.slice(\r\n            (this.currentPage - 1) * this.limit,\r\n            this.limit * this.currentPage\r\n          );\r\n          this.total = result.data.length;\r\n      } else {\r\n        this.$message.error(\"数据获取异常\");\r\n      }\r\n    },\r\n\r\n    // 回收处理\r\n    async handle(status) {\r\n      let params = {\r\n        eid: this.rows.eid,\r\n        status: status,\r\n        rid: this.rows.rid,\r\n      };\r\n      const result = await this.$store.dispatch(\"recyclingEquip\", params);\r\n      if (result.code == 200) {\r\n        this.$notify.success({ title: \"回收成功\" });\r\n        this.getRecyclingEquipList();\r\n        this.isShow = false;\r\n      } else {\r\n        this.$notify.error({ title: \"回收失败\" });\r\n        this.isShow = false;\r\n      }\r\n    },\r\n\r\n    // 失信处理\r\n    // 先更新该笔借用租用状态未4，过期未归还，在设置用户账号status=2异常\r\n    noCredit(row) {\r\n      if (Date.parse(row.backtime) < new Date()) {\r\n        this.$comfirm(\"是否确认将用户列入失信名单？\", \"提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n          center: true,\r\n        }).then(async () => {\r\n          const result = await this.$store.dispatch(\"dealNocredit\", {\r\n            uid: row.uid,\r\n            eid: row.eid,\r\n          });\r\n          if (result.code == 200) {\r\n            this.$notify.success({\r\n              title: \"已列入失信名单\",\r\n              message: \"该用户将不能进行申请操作\",\r\n            });\r\n            this.getRecyclingEquipList();\r\n          } else {\r\n            this.$notify.error({ title: \"操作失败\" });\r\n          }\r\n        });\r\n      } else {\r\n        this.$message.error(\"使用期限内，不能进行该操作\");\r\n      }\r\n    },\r\n    // 分页器\r\n    handleCurrentChange(val) {\r\n      this.currentPage = val;\r\n      this.getRecyclingEquipList();\r\n    },\r\n    handleSizeChange(val) {\r\n      this.limit = val;\r\n      this.currentPage = 1;\r\n      this.getRecyclingEquipList();\r\n    },\r\n    // 搜索\r\n    toSearch() {\r\n      if (this.search) {\r\n        let that = this\r\n        this.flag = false\r\n        this.rentList = []\r\n        this.rentList = this.data.filter(item => {\r\n          return Object.keys(item).some(function (key) {\r\n            //搜索所有的内容\r\n            return String(item[key]).toLowerCase().indexOf(that.search) > -1;\r\n            //只搜索问题内容（某一个key）\r\n            // return (\r\n            //   String(product[\"questions\"]).toLowerCase().indexOf(search) > -1\r\n            // );\r\n          });\r\n        });\r\n        // return searchVal;\r\n        // console.log(this.showList)\r\n      } else {\r\n        this.flag = true\r\n        this.getRecyclingEquipList();\r\n      }\r\n    },\r\n    SearchList(){\r\n      if(!this.search){\r\n        this.getRecyclingEquipList()\r\n        this.flag = true\r\n      }\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.search {\r\n  width: 200px;\r\n  border-radius: 30px;\r\n  position: relative;\r\n  right: -1000px;\r\n}\r\n.btn {\r\n  position: relative;\r\n  right: -1020px;\r\n}\r\n</style>\r\n"]}]}