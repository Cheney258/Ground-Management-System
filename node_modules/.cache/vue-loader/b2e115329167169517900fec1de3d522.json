{"remainingRequest":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\src\\views\\users\\apply\\game.vue?vue&type=style&index=0&id=55d8c918&lang=sass&scoped=true&","dependencies":[{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\src\\views\\users\\apply\\game.vue","mtime":1646458141211},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地管理系统\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmNvbnRhaW5lci1jbGFzc3sNCiAgICBtYXJnaW46IGF1dG87DQogICAgd2lkdGg6IDkwJTsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgLyogYmFja2dyb3VuZC1jb2xvcjogbGlnaHRncmF5OyAqLw0KfQ0KLmZvcm0tY2xhc3N7DQogICAgbWFyZ2luOiBhdXRvOw0KICAgIHdpZHRoOiA1MCU7DQogICAgaGVpZ2h0OiA4MCU7DQogICAgcGFkZGluZzogMzBweCAxMHB4Ow0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgLyogYmFja2dyb3VuZC1jb2xvcjogcmVkOyAqLw0KfQ0KLmN0c3QtYXBwaWQtY2xhc3N7DQogICAgY29sb3I6IHJlZDsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCn0NCi5wcm9ncmVzcy1jbGFzc3sNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgc2l6ZTogNTBweDsNCiAgICBwYWRkaW5nLXRvcDogMTAlOw0KfQ0KLnN1Y2NNc2ctY2xhc3N7DQogICAgcGFkZGluZy10b3A6IDIwcHg7DQogICAgcGFkZGluZy1ib3R0b206IDEwcHg7DQogICAgZm9udC1zaXplOiAyN3B4Ow0KfQ0K"},{"version":3,"sources":["game.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"game.vue","sourceRoot":"src/views/users/apply","sourcesContent":["<template>\r\n  <div class=\"container-class\">\r\n        <!-- 进度条 -->\r\n        <el-steps :active=\"active\" finish-status=\"success\" align-center class=\"loadingbar\">\r\n            <el-step title=\"填写赛事申请信息\"></el-step>\r\n            <el-step title=\"等待审核结果\"></el-step>\r\n            <el-step title=\"获得场地审批号\"></el-step>\r\n        </el-steps>\r\n        <!-- 表单 -->\r\n        <div class=\"form-class\" v-show=\"active == 0\">\r\n            <el-form label-position=\"left\" :model=\"ctstApplication\" :rules=\"rules\" ref=\"contestAppForm\" label-width=\"100px\">\r\n                <el-form-item label=\"申请编号\" prop=\"contestId\">\r\n                    <span class=\"ctst-appid-class\">{{ctstApplication.contestId}}</span>\r\n                </el-form-item>\r\n                <el-form-item label=\"申请人姓名\">\r\n                    <!-- <el-input v-model=\"ctstApplication.username\"></el-input> -->\r\n                    {{username}}\r\n                </el-form-item>\r\n                <el-form-item label=\"活动类型\" prop=\"activityType\">\r\n                    <el-select v-model=\"ctstApplication.activityType\" value-key placeholder=\"请选择\" @change=\"changeType\">\r\n                        <el-option label=\"上课\" value=\"上课\"></el-option>\r\n                        <el-option label=\"比赛\" value=\"比赛\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item :label=\"isContest == false ? '活动时间' : '比赛时间'\" prop=\"contestTime\">\r\n                    <el-col :span=\"11\">\r\n                        <el-date-picker type=\"date\" value-format=\"yyyy-MM-dd\" placeholder=\"选择日期\" v-model=\"ctstApplication.contestTime\" style=\"width: 100%;\"></el-date-picker>\r\n                    </el-col>\r\n                </el-form-item>\r\n                <!-- 如果是比赛才显示 -->\r\n                <el-form-item label=\"项目\" prop=\"sportId\">\r\n                    <el-select v-model=\"ctstApplication.sportId\" placeholder=\"请选择赛事项目\">\r\n                        <!-- 用v-for从返回数据中生成 -->\r\n                        <el-option\r\n                            v-for=\"item in sportList\"\r\n                            :key=\"item.id\"\r\n                            :label=\"item.sportName\"\r\n                            :value=\"item.id\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item :label=\"isContest == false ? '活动名称' : '赛事名称'\" prop=\"contestName\">\r\n                    <el-input v-model=\"ctstApplication.contestName\"></el-input>\r\n                </el-form-item>\r\n                <!-- 比赛时 -->\r\n                <el-form-item label=\"比赛队伍\" required v-show=\"isContest\">\r\n                    <el-col :span=\"11\">\r\n                        <el-form-item prop=\"contestTeam1\">\r\n                            <el-input v-model=\"ctstApplication.contestTeam1\"></el-input>\r\n                        </el-form-item>\r\n                    </el-col>\r\n                    <el-col :span=\"2\" style=\"text-align: center;\">\r\n                        vs\r\n                    </el-col>\r\n                    <el-col :span=\"11\">\r\n                        <el-form-item prop=\"contestTeam2\">\r\n                            <el-input v-model=\"ctstApplication.contestTeam2\"></el-input>\r\n                        </el-form-item>\r\n                    </el-col>\r\n                </el-form-item>\r\n                <!-- 活动时 -->\r\n                <el-form-item label=\"班级\" required v-show=\"!isContest\">\r\n                    <el-form-item prop=\"contestTeam1\">\r\n                        <el-input v-model=\"ctstApplication.contestTeam1\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item prop=\"contestTeam2\" v-show=\"false\">\r\n                        <el-input v-model=\"ctstApplication.contestTeam2\"></el-input>\r\n                    </el-form-item>\r\n                </el-form-item>\r\n                <el-form-item label=\"活动描述\" prop=\"activityDescription\">\r\n                    <!-- <el-input></el-input> -->\r\n                    <el-input type=\"textarea\" v-model=\"ctstApplication.activityDescription\"></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n        <!-- 已提交，75%进度 -->\r\n        <div v-show=\"active == 1\" class=\"form-class progress-class\">\r\n            <el-progress type=\"circle\" :percentage=\"75\" :width=\"200\"></el-progress>\r\n            <div>\r\n                <div class=\"succMsg-class\">提交成功</div>\r\n                <span>申请编号为{{ctstApplication.contestId}}的赛事申请已提交，待赛事管理员审批通过后即可申请场地和器材</span>\r\n            </div>\r\n        </div>\r\n        <el-button style=\"margin-top: 12px; margin-left: center;\" @click=\"submit()\"  v-show=\"active == 0\">提交申请</el-button>\r\n        <el-button style=\"margin-top: 12px;\" @click=\"back()\" v-show=\"active == 1\">再次申请</el-button>\r\n        <!-- 测试用块 -->\r\n        <!-- <div>\r\n            {{sportList}}\r\n        </div> -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            active: 0,\r\n            user: '',\r\n            userId: '',\r\n            username: '',\r\n            ctstApplication: {\r\n                contestId: 'GS' + (Math.round((Math.random()+1)*1000)),\r\n                userId: this.userId,\r\n                activityType: '',\r\n                sportId: '',\r\n                contestName: '',\r\n                contestTeam: '',\r\n                contestTeam1: '',\r\n                contestTeam2: ' ',\r\n                activityDescription: '',\r\n                contestTime: '',\r\n                roleId: '',\r\n            },\r\n            sportList: [],\r\n            rules:{\r\n                username: [\r\n                    { required: true, message: '请输入申请人姓名', trigger: 'blur' },\r\n                    { min: 2, max: 10, message: '长度在 2 到 10 个字符', trigger: 'blur' },\r\n                ],\r\n                activityType: [\r\n                    { required: true, message: '请选择活动类型', trigger: 'change' },\r\n                ],\r\n                contestTime: [\r\n                    { type: 'string', required: true, message: '请选择日期', trigger: 'change' },\r\n                ],\r\n                sportId: [\r\n                    { required: true, message: '请选择项目', trigger: 'change' },\r\n                ],\r\n                contestName: [\r\n                    { required: true, message: '请填写赛事名称', trigger: 'blur' },\r\n                ],\r\n                contestTeam1: [\r\n                    { required: true, message: '请填写比赛队伍', trigger: 'blur' },\r\n                ],\r\n                contestTeam2: [\r\n                    { required: true, message: '请填写比赛队伍', trigger: 'blur' },\r\n                ],\r\n            },\r\n            isContest: false,\r\n        }\r\n    },\r\n    methods: {\r\n        submit() {\r\n            if(this.ctstApplication.activityType == '上课'){\r\n                this.ctstApplication.contestTeam = this.ctstApplication.contestTeam1;\r\n            }else{\r\n                this.ctstApplication.contestTeam = this.ctstApplication.contestTeam1 + ' vs ' + this.ctstApplication.contestTeam2;\r\n            }\r\n            this.ctstApplication.userId = this.userId;\r\n            console.log(this.ctstApplication);\r\n            this.$refs.contestAppForm.validate(async valid => {\r\n                if (!valid) {\r\n                   return ;\r\n                }\r\n                //验证成功,发送请求\r\n                // console.log(this.user[0].role_id);\r\n                this.ctstApplication.roleId = this.user[0].role_id;\r\n                const {data :res} = await this.$http.post('http://localhost:9001/contestApplication/saveContestApplication', this.$qs.stringify(this.ctstApplication));\r\n                if (this.active++ > 2) this.active = 0;\r\n            });\r\n        },\r\n        back(){\r\n            this.active = 0;\r\n            this.$refs.contestAppForm.resetFields();\r\n            this.ctstApplication.contestId = 'GS' + (Math.round((Math.random()+1)*1000))\r\n        },\r\n        changeType(value){\r\n            if (value == '比赛'){\r\n                this.isContest = true;\r\n            }else{\r\n                this.isContest = false;\r\n            }\r\n        },\r\n        async findSport(){\r\n            const {data :res} = await this.$http.post('http://localhost:9001/sport/list', this.$qs.stringify({\r\n                status: 1,\r\n            }));\r\n            this.sportList = res.data;\r\n            // console.log(\"0sportList:\", sportList);\r\n        }\r\n    },\r\n    created() {\r\n        //查询可用项目\r\n        this.findSport();\r\n        this.user = JSON.parse(window.localStorage.getItem(\"user\"));// 取出session里当前登录用户\r\n        // console.log(this.user);\r\n        if(this.user != null){\r\n            this.userId = this.user[0].user_id;\r\n            this.username = this.user[0].username;\r\n        }else{\r\n            this.$message.error(\"未获取到当前登录用户，请重新登录\");\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"sass\" scoped>\r\n.container-class{\r\n    margin: auto;\r\n    width: 90%;\r\n    height: 100%;\r\n    /* background-color: lightgray; */\r\n}\r\n.form-class{\r\n    margin: auto;\r\n    width: 50%;\r\n    height: 80%;\r\n    padding: 30px 10px;\r\n    box-sizing: border-box;\r\n    /* background-color: red; */\r\n}\r\n.ctst-appid-class{\r\n    color: red;\r\n    font-weight: bold;\r\n}\r\n.progress-class{\r\n    text-align: center;\r\n    size: 50px;\r\n    padding-top: 10%;\r\n}\r\n.succMsg-class{\r\n    padding-top: 20px;\r\n    padding-bottom: 10px;\r\n    font-size: 27px;\r\n}\r\n</style>\r\n"]}]}