{"remainingRequest":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\src\\views\\admin\\users\\Users.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\src\\views\\admin\\users\\Users.vue","mtime":1649066569914},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdVc2VycycsDQoNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdXNlcnNMaXN0OltdLA0KICAgICAgZmxhZzp0cnVlLA0KICAgICAgdXNlcmluZm86e3JvbGU6Jycsc3RhdHVzOicnfSwNCiAgICAgIHNlYXJjaDonJywNCiAgICAgIGlzU2hvdzpmYWxzZSwNCiAgICAgIGRhdGE6W10sDQogICAgICBjdXJyZW50UGFnZTogMSwNCiAgICAgICAgICAgIGxpbWl0OiA1LA0KICAgICAgICAgICAgdG90YWw6IDAsDQogICAgICAgICAgICBwYWdlU2l6ZXM6WzUsMTAsMTUsMjBdDQogICAgfQ0KICB9LA0KDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5nZXRBbGxVc2VycygpDQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIC8vIOiOt+WPluaJgOacieeahOeUqOaItw0KICAgIGFzeW5jIGdldEFsbFVzZXJzKCl7DQogICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dldEFsbFVzZXJzJykNCiAgICAgIGlmKHJlc3VsdHMuY29kZSA9PSAyMDAgKXsNCiAgICAgICAgdGhpcy5kYXRhID0gcmVzdWx0cy5kYXRhDQogICAgICAgIHRoaXMudXNlcnNMaXN0ID0gW10NCiAgICAgICAgdGhpcy51c2Vyc0xpc3QgPSByZXN1bHRzLmRhdGEuc2xpY2UoKHRoaXMuY3VycmVudFBhZ2UtMSkqdGhpcy5saW1pdCx0aGlzLmxpbWl0KnRoaXMuY3VycmVudFBhZ2UpOw0KICAgICAgICB0aGlzLnRvdGFsID0gcmVzdWx0cy5kYXRhLmxlbmd0aA0KICAgICAgfWVsc2V7DQogICAgICAgIHRoaXMuJG5vdGlmeS5lcnJvcih7dGl0bGU6J+iOt+WPluaVsOaNruWksei0pSd9KQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvLyDnvJbovpENCiAgICBlZGl0KHJvdyl7DQogICAgICB0aGlzLmlzU2hvdyA9IHRydWUNCiAgICAgIHRoaXMudXNlcmluZm8gPSByb3cNCiAgICAgIHRoaXMudXNlcmluZm8ucm9sZSA9IHJvdy5yb2xlDQogICAgICB0aGlzLnVzZXJpbmZvLnN0YXR1cyA9IHJvdy5zdGF0dXMNCiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudXNlcmluZm8pDQogICAgICAvLyBjb25zb2xlLmxvZyhyb3cpDQogICAgfSwNCg0KICAgIC8vIOaPkOS6pOS/ruaUuQ0KICAgIGFzeW5jIHN1Ym1pdCgpew0KICAgICAgbGV0IHBhcmFtcyA9IHsNCiAgICAgICAgdWlkOnRoaXMudXNlcmluZm8udWlkLA0KICAgICAgICByb2xlOnRoaXMudXNlcmluZm8ucm9sZSwNCiAgICAgICAgc3RhdHVzOnRoaXMudXNlcmluZm8uc3RhdHVzDQogICAgICB9DQogICAgICAvLyBjb25zb2xlLmxvZyhwYXJhbXMpDQogICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndXBkYXRlUm9sZUFuZFN0YXR1cycscGFyYW1zKQ0KICAgICAgaWYocmVzdWx0LmNvZGUgPT0gMjAwKXsNCiAgICAgICAgdGhpcy4kbm90aWZ5LnN1Y2Nlc3Moe3RpdGxlOifmm7TmlrDmiJDlip8nfSkNCiAgICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZQ0KICAgICAgfWVsc2V7DQogICAgICAgIHRoaXMuJG5vdGlmeS5lcnJvcih7dGl0bGU6J+abtOaWsOWksei0pSd9KQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvLyDms6jplIDotKbmiLcNCiAgICBhc3luYyBsb2dvZmYocm93KXsNCiAgICAgIGNvbnN0IHBhcmFtczEgPXt1aWQ6cm93LnVpZCxyb2xlOnJvdy5yb2xlLHN0YXR1czozfQ0KICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VwZGF0ZVJvbGVBbmRTdGF0dXMnLHBhcmFtczEpDQogICAgICBpZihyZXN1bHQuY29kZSA9PTIwMCl7DQogICAgICAgIHRoaXMuJG5vdGlmeS5zdWNjZXNzKHt0aXRsZTon5rOo6ZSA5oiQ5YqfJ30pDQogICAgICAgIC8vIOWIt+aWsOeUqOaIt+S/oeaBrw0KICAgICAgICB0aGlzLmdldEFsbFVzZXJzKCkNCiAgICAgIH1lbHNlew0KICAgICAgICB0aGlzLiRub3RpZnkuZXJyb3Ioe3RpdGxlOifms6jplIDlpLHotKUnfSkNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLy8g5YiG6aG15ZmoDQogICAgICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7DQogICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gdmFsOw0KICAgICAgICAgICAgdGhpcy5nZXRBbGxVc2VycygpOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVTaXplQ2hhbmdlKHZhbCkgew0KICAgICAgICAgICAgdGhpcy5saW1pdCA9IHZhbA0KICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDE7DQogICAgICAgICAgICB0aGlzLmdldEFsbFVzZXJzKCk7DQogICAgICAgIH0sDQogICAgLy8g5pCc57SiDQogICAgdG9TZWFyY2goKSB7DQogICAgICBpZiAodGhpcy5zZWFyY2gpIHsNCiAgICAgICAgbGV0IHRoYXQgPSB0aGlzDQogICAgICAgIHRoaXMuZmxhZyA9IGZhbHNlDQogICAgICAgIHRoaXMudXNlcnNMaXN0ID0gW10NCiAgICAgICAgdGhpcy51c2Vyc0xpc3QgPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhpdGVtKS5zb21lKGZ1bmN0aW9uIChrZXkpIHsNCiAgICAgICAgICAgIC8v5pCc57Si5omA5pyJ55qE5YaF5a65DQogICAgICAgICAgICByZXR1cm4gU3RyaW5nKGl0ZW1ba2V5XSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRoYXQuc2VhcmNoKSA+IC0xOw0KICAgICAgICAgICAgLy/lj6rmkJzntKLpl67popjlhoXlrrnvvIjmn5DkuIDkuKprZXnvvIkNCiAgICAgICAgICAgIC8vIHJldHVybiAoDQogICAgICAgICAgICAvLyAgIFN0cmluZyhwcm9kdWN0WyJxdWVzdGlvbnMiXSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHNlYXJjaCkgPiAtMQ0KICAgICAgICAgICAgLy8gKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICAgIC8vIHJldHVybiBzZWFyY2hWYWw7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuc2hvd0xpc3QpDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmZsYWcgPSB0cnVlDQogICAgICAgIHRoaXMuZ2V0QWxsVXNlcnMoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIFNlYXJjaExpc3QoKXsNCiAgICAgIGlmKCF0aGlzLnNlYXJjaCl7DQogICAgICAgIHRoaXMuZ2V0QWxsVXNlcnMoKQ0KICAgICAgICB0aGlzLmZsYWcgPSB0cnVlDQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["Users.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Users.vue","sourceRoot":"src/views/admin/users","sourcesContent":["<template>\r\n  <div>\r\n    <el-card class=\"card\">\r\n      <div slot=\"header\">\r\n        <el-input\r\n          v-model=\"search\"\r\n          placeholder=\"请输入关键字...\"\r\n          class=\"search\"\r\n          @change=\"SearchList\"\r\n          clearable\r\n        ></el-input>\r\n        <el-button type=\"primary\" class=\"btn\" @click=\"toSearch\">搜索</el-button>\r\n      </div>\r\n      <div class=\"container\">\r\n      <el-table :data=\"usersList\" style=\"width: 100%\" align=\"center\">\r\n        <el-table-column prop=\"name\" label=\"用户ID\" width=\"width\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"width\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"xuehao\" label=\"学号\" width=\"width\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"sex\" label=\"性别\" width=\"width\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"email\" label=\"邮箱\" width=\"width\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"phone\" label=\"联系电话\" width=\"width\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"role\" label=\"用户角色\" width=\"width\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n          <el-tag type=\"info\" v-if=\"scope.row.role == 1\" >用户</el-tag>\r\n          <el-tag type=\"danger\" v-if=\"scope.row.role == 2\" >管理员</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" label=\"账号状态\" width=\"width\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag type=\"success\" v-if=\"scope.row.status == 1\" >正常</el-tag>\r\n            <el-tag type=\"warning\" v-if=\"scope.row.status == 2\">失信</el-tag>\r\n            <el-tag type=\"danger\" v-if=\"scope.row.status == 3\">注销</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"prop\" label=\"操作\" width=\"250\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"warning\" icon=\"el-icon-edit\" @click=\"edit(scope.row)\">修 改</el-button>\r\n            <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"logoff(scope.row)\">注 销</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n    <pagination \r\n        v-show=\"flag\"\r\n        :currentPage=\"currentPage\" \r\n        :total=\"total\" \r\n        :limit=\"limit\" \r\n        :page-sizes='pageSizes'\r\n        @handleCurrentChange=\"handleCurrentChange\" \r\n        @handleSizeChange=\"handleSizeChange\"/>\r\n    </el-card>\r\n    <!-- 修改 -->\r\n    <el-dialog title=\"用户信息更新\" :visible.sync=\"isShow\" width=\"width\">\r\n      <div style=\"width:350px; margin:0px auto\">\r\n        <el-form ref=\"form\" :model=\"userinfo\" label-width=\"100px\" >\r\n          <el-form-item label=\"用户ID：\">\r\n          <span style=\"font-size:16px;font-weight:700;\"> {{userinfo.name}} </span>\r\n          </el-form-item>\r\n          <el-form-item label=\"用户姓名：\">\r\n            <span style=\"font-size:16px;font-weight:700;\"> {{userinfo.username}} </span>\r\n          </el-form-item>\r\n          <el-form-item label=\"学  号：\">\r\n            <span style=\"font-size:16px;font-weight:700;\"> {{userinfo.xuehao}} </span>\r\n            \r\n          </el-form-item>\r\n          <el-form-item label=\"性  别：\">\r\n            <span style=\"font-size:16px;font-weight:700;\"> {{userinfo.sex}} </span>\r\n            \r\n          </el-form-item>\r\n          <el-form-item label=\"邮  箱：\">\r\n            <span style=\"font-size:16px;font-weight:700;\"> {{userinfo.email}} </span>\r\n          \r\n          </el-form-item>\r\n          <el-form-item label=\"联系电话：\">\r\n            <span style=\"font-size:16px;font-weight:700;\"> {{userinfo.phone}} </span>\r\n            \r\n          </el-form-item>\r\n          <el-form-item label=\"用户角色：\">\r\n            <el-radio-group v-model=\"userinfo.role\">\r\n              <el-radio :label=\"1\">用户</el-radio>\r\n              <el-radio :label=\"2\">管理员</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"账号状态：\">\r\n            <el-radio-group v-model=\"userinfo.status\">\r\n              <el-radio :label=\"1\">正常</el-radio>\r\n              <el-radio :label=\"2\">异常</el-radio>\r\n              <el-radio :label=\"3\">已注销</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n      <div slot=\"footer\" style=\"text-align:center\">\r\n        <el-button style=\"margin:0px 25px\" @click=\"isShow = false\">取 消</el-button>\r\n        <el-button style=\"margin:0px 25px\" type=\"primary\" @click=\"submit\">提交修改</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Users',\r\n\r\n  data() {\r\n    return {\r\n      usersList:[],\r\n      flag:true,\r\n      userinfo:{role:'',status:''},\r\n      search:'',\r\n      isShow:false,\r\n      data:[],\r\n      currentPage: 1,\r\n            limit: 5,\r\n            total: 0,\r\n            pageSizes:[5,10,15,20]\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.getAllUsers()\r\n  },\r\n\r\n  methods: {\r\n    // 获取所有的用户\r\n    async getAllUsers(){\r\n      const results = await this.$store.dispatch('getAllUsers')\r\n      if(results.code == 200 ){\r\n        this.data = results.data\r\n        this.usersList = []\r\n        this.usersList = results.data.slice((this.currentPage-1)*this.limit,this.limit*this.currentPage);\r\n        this.total = results.data.length\r\n      }else{\r\n        this.$notify.error({title:'获取数据失败'})\r\n      }\r\n    },\r\n\r\n    // 编辑\r\n    edit(row){\r\n      this.isShow = true\r\n      this.userinfo = row\r\n      this.userinfo.role = row.role\r\n      this.userinfo.status = row.status\r\n      // console.log(this.userinfo)\r\n      // console.log(row)\r\n    },\r\n\r\n    // 提交修改\r\n    async submit(){\r\n      let params = {\r\n        uid:this.userinfo.uid,\r\n        role:this.userinfo.role,\r\n        status:this.userinfo.status\r\n      }\r\n      // console.log(params)\r\n      const result = await this.$store.dispatch('updateRoleAndStatus',params)\r\n      if(result.code == 200){\r\n        this.$notify.success({title:'更新成功'})\r\n        this.isShow = false\r\n      }else{\r\n        this.$notify.error({title:'更新失败'})\r\n      }\r\n    },\r\n\r\n    // 注销账户\r\n    async logoff(row){\r\n      const params1 ={uid:row.uid,role:row.role,status:3}\r\n      const result = await this.$store.dispatch('updateRoleAndStatus',params1)\r\n      if(result.code ==200){\r\n        this.$notify.success({title:'注销成功'})\r\n        // 刷新用户信息\r\n        this.getAllUsers()\r\n      }else{\r\n        this.$notify.error({title:'注销失败'})\r\n      }\r\n    },\r\n\r\n    // 分页器\r\n        handleCurrentChange(val) {\r\n            this.currentPage = val;\r\n            this.getAllUsers();\r\n        },\r\n        handleSizeChange(val) {\r\n            this.limit = val\r\n            this.currentPage = 1;\r\n            this.getAllUsers();\r\n        },\r\n    // 搜索\r\n    toSearch() {\r\n      if (this.search) {\r\n        let that = this\r\n        this.flag = false\r\n        this.usersList = []\r\n        this.usersList = this.data.filter(item => {\r\n          return Object.keys(item).some(function (key) {\r\n            //搜索所有的内容\r\n            return String(item[key]).toLowerCase().indexOf(that.search) > -1;\r\n            //只搜索问题内容（某一个key）\r\n            // return (\r\n            //   String(product[\"questions\"]).toLowerCase().indexOf(search) > -1\r\n            // );\r\n          });\r\n        });\r\n        // return searchVal;\r\n        // console.log(this.showList)\r\n      } else {\r\n        this.flag = true\r\n        this.getAllUsers();\r\n      }\r\n    },\r\n    SearchList(){\r\n      if(!this.search){\r\n        this.getAllUsers()\r\n        this.flag = true\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.search {\r\n  width: 200px;\r\n  border-radius: 30px;\r\n  position: relative;\r\n  right: -1000px;\r\n}\r\n.btn {\r\n  position: relative;\r\n  right: -1020px;\r\n}\r\n.input{\r\n  width: 180px;\r\n}\r\n</style>\r\n<style>\r\n.el-table__row{\r\n  height: 90px!important;\r\n}\r\n</style>\r\n"]}]}