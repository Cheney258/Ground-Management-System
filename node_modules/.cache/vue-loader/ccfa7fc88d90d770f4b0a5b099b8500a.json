{"remainingRequest":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\src\\components\\upload\\index.vue?vue&type=style&index=0&id=62f4c554&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\src\\components\\upload\\index.vue","mtime":1648877267576},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\22419\\Desktop\\校园运动场地系统\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLyogLy8g6K6+572u5LiK5Lyg5Li6bm9uZe+8jOWPr+S7peWKoOS4quWKqOeUu+S7gOS5iOS5i+exu+eahCAqLw0KOjp2LWRlZXAgLmhpZGUgLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsNCiAgZGlzcGxheTogbm9uZTsNCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsIA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/upload","sourcesContent":["<template>\r\n  <div class=\"upload\">\r\n    <el-upload\r\n      action=\"\"\r\n      :class=\"{hide:isUpload}\"\r\n      :auto-upload=\"autoUpload\"\r\n      :http-request=\"upload\"\r\n      list-type=\"picture-card\"\r\n      multiple\r\n      :limit=\"limit\"\r\n      :file-list=\"fileList\"\r\n      :accept=\"accept\"\r\n      ref=\"upload\"\r\n      :name=\"name\"\r\n      :on-change=\"handleChange\"\r\n      :on-exceed=\"handleExceed\"\r\n    >\r\n      <i slot=\"default\" class=\"el-icon-plus\"></i>\r\n      <div slot=\"file\" slot-scope=\"{ file }\">\r\n        <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\" />\r\n        <span class=\"el-upload-list__item-actions\">\r\n          <span\r\n            class=\"el-upload-list__item-preview\"\r\n            @click=\"handlePictureCardPreview(file)\"\r\n          >\r\n            <i class=\"el-icon-zoom-in\"></i>\r\n          </span>\r\n          <span\r\n            v-if=\"!disabled\"\r\n            class=\"el-upload-list__item-delete\"\r\n            @click=\"handleRemove(file)\"\r\n          >\r\n            <i class=\"el-icon-delete\"></i>\r\n          </span>\r\n        </span>\r\n      </div>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Upload\",\r\n  props: {\r\n    accept: {\r\n      type: String,\r\n      default: \"image/*\"\r\n    },\r\n    limit: {\r\n      type: Number,\r\n      default: 5\r\n    },\r\n    name: {\r\n      type: String,\r\n      default: \"file\"\r\n    },\r\n    autoUpload: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    fileList: {\r\n      type: Array,\r\n      default() {\r\n        return [];\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      dialogImageUrl: \"\",\r\n      dialogVisible: false,\r\n      disabled: false,\r\n      isUpload: false,\r\n    };\r\n  },\r\n  methods: {\r\n    handleChange(file, fileList) {\r\n      // 判断上传文件是否达到限制\r\n      this.isUpload = fileList.length >= this.limit\r\n      // 由于设置自动上传为false,before-upload钩子失效，所以在on-change中检验文件是否符合要求\r\n      const isJPG = ~[\"image/jpeg\", \"image/png\"].indexOf(file.raw.type);\r\n      const isLt2M = file.raw.size / 1024 / 1024 < 2;\r\n      if (!isJPG) {\r\n        this.$message.error(\"上传图片只能是 jpg 格式!\")\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\")\r\n      } \r\n      if(!isJPG || !isLt2M){\r\n      // 不符合直接删除该文件\r\n        this.handleRemove(file)\r\n      }\r\n    },\r\n    // 删除图片\r\n    handleRemove(file) {\r\n      let fileList = this.$refs.upload.uploadFiles;\r\n      let index = fileList.findIndex(fileItem => {\r\n        return fileItem.uid === file.uid;\r\n      });\r\n      fileList.splice(index, 1);\r\n      // 由于删除组件有动画功能，所以设置个延迟显示\r\n      setTimeout(()=>{\r\n        this.isUpload = false\r\n      },1000)\r\n    },\r\n    // 预览图片\r\n    handlePictureCardPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    // 文件超出限制的提示\r\n    handleExceed(file, fileList) {\r\n      this.$message.error(\"文件个数超出限制\");\r\n    },\r\n    upload() {\r\n      // const formData = new FormData();\r\n      // const file = this.$refs.uploadImg.$refs.upload.uploadFiles;\r\n      // const headerConfig = {\r\n      //   headers: { \"Content-Type\": \"multipart/form-data\" }\r\n      // };\r\n      // file.forEach(item => {\r\n      //   formData.append(\"file\", item.raw)\r\n      // });\r\n      // let {data:res} = await this.$http.post(\"upload/uploadTest\", formData, headerConfig);\r\n      // console.log(res,'res');\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style  scoped>\r\n/* // 设置上传为none，可以加个动画什么之类的 */\r\n::v-deep .hide .el-upload--picture-card {\r\n  display: none;\r\n}\r\n</style>"]}]}